server:
  port: 8060
  forward-headers-strategy: framework
  max-http-request-header-size: 200000000
  tomcat:
    max-http-form-post-size: 200000000
    max-swallow-size: 200000000

spring:
  application:
    name: skch-gateway-service

  cloud:
    gateway:
      server:
        webflux:

          # =========================
          # GLOBAL CORS CONFIGURATION
          # =========================
          globalcors:
            add-to-simple-url-handler-mapping: true
            cors-configurations:
              '[/**]':
                allowed-origins:
                  - http://localhost:5173
                allowed-methods:
                  - GET
                  - POST
                  - PUT
                  - DELETE
                  - OPTIONS
                allowed-headers:
                  - Authorization
                  - Content-Type
                  - RequestVerify
                allow-credentials: true

          # =========================
          # GLOBAL RATE LIMITING
          # =========================
          default-filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 4
                redis-rate-limiter.burstCapacity: 4
                redis-rate-limiter.requestedTokens: 1
                key-resolver: "#{@ipKeyResolver}"

          # =========================
          # ROUTES
          # =========================
          routes:
            # API SERVICE (8062)
            - id: api-service
              uri: http://localhost:8062
              predicates:
                - Path=/apiService/**
              filters:
                - StripPrefix=1

            # AUTH / OAUTH2 SERVICE (8061)
            - id: oauth2-service
              uri: http://localhost:8061
              predicates:
                - Path=/authService/**
              filters:
                - StripPrefix=1

    loadbalancer:
      enabled: true

  # =========================
  # SECURITY (JWT RESOURCE SERVER)
  # =========================
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: http://localhost:8061

  # =========================
  # REDIS CONFIGURATION
  # =========================
  data:
    redis:
      host: localhost
      port: 6379
      password: Redis@123
      timeout: 2000

# =========================
# LOGGING
# =========================
logging:
  level:
    root: INFO
    org.springframework.cloud.gateway: DEBUG